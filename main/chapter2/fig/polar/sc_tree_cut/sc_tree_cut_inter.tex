\providecommand{\datapath}{.}
\documentclass[tikz]{standalone}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{eulervm}
\usepackage{amsmath}
\usepackage{pgfplots}

\pgfplotsset{compat=newest}
\usepgfplotslibrary{colorbrewer}
\usepgfplotslibrary{groupplots}
\usetikzlibrary{matrix, positioning, patterns}

\input{./settings/colors}

\begin{document}
  \begin{tikzpicture}[every axis/.style={
                      /pgfplots/table/ignore chars={|}, %footnotesize,
                      width=1.0\linewidth, height=0.70\linewidth,
                      xticklabel style={black!70}, yticklabel style={black!70},
                      % tick align=outside, tickpos=left,
                      ybar stacked, bar width=14pt,
                      legend style={at={(0.39,0.95)}, anchor=north}, legend columns=-1,
                      ylabel={Coded throughput (Mb/s)}, xlabel={Code rate ($R = K / N$)},
                      ymajorgrids, grid style={gray!30}, grid style={dashed, gray!50}, xmin=0.05, xmax=0.45, xtick=data, ymin=0, ymax=2000.0,
                      x tick label style={rotate=-45}, xticklabels={1/5, 1/2, 5/6, 9/10}}]

    \begin{axis}[bar shift=-20pt]
      \addplot+[draw=black,    fill=black!50                                                                                 ] table [x=R, y expr=\thisrowno{4}              ] {\datapath/dat/E31225_samples_inter_8b_opti_spc4.dat};
      \addplot+[draw=Paired-1, fill=Paired-1!40, postaction={pattern color = black!80!Paired-1!70, pattern=north west  lines}] table [x=R, y expr=\thisrowno{5}-\thisrowno{4}] {\datapath/dat/E31225_samples_inter_8b_opti_spc4.dat};
      \addplot+[draw=Paired-3, fill=Paired-3!40, postaction={pattern color = black!80!Paired-3!70, pattern=north east  lines}] table [x=R, y expr=\thisrowno{6}-\thisrowno{5}] {\datapath/dat/E31225_samples_inter_8b_opti_spc4.dat};
      \addplot+[draw=Paired-7, fill=Paired-7!40, postaction={pattern color = black!80!Paired-7!70, pattern=crosshatch  dots} ] table [x=R, y expr=\thisrowno{7}-\thisrowno{6}] {\datapath/dat/E31225_samples_inter_8b_opti_spc4.dat};
      \addplot+[draw=Paired-5, fill=Paired-5!40, postaction={pattern color = black!80!Paired-5!70, pattern=horizontal lines} ] table [x=R, y expr=\thisrowno{8}-\thisrowno{7}] {\datapath/dat/E31225_samples_inter_8b_opti_spc4.dat};
    \end{axis}

    \begin{axis}[hide axis]
      \addplot+[draw=black,    fill=black!50                                                                                 ] table [x=R, y expr=\thisrowno{4}              ] {\datapath/dat/E31225_samples_inter_8b_opti_spc4+.dat};
      \addplot+[draw=Paired-1, fill=Paired-1!40, postaction={pattern color = black!80!Paired-1!70, pattern=north west  lines}] table [x=R, y expr=\thisrowno{5}-\thisrowno{4}] {\datapath/dat/E31225_samples_inter_8b_opti_spc4+.dat};
      \addplot+[draw=Paired-3, fill=Paired-3!40, postaction={pattern color = black!80!Paired-3!70, pattern=north east  lines}] table [x=R, y expr=\thisrowno{6}-\thisrowno{5}] {\datapath/dat/E31225_samples_inter_8b_opti_spc4+.dat};
      \addplot+[draw=Paired-7, fill=Paired-7!40, postaction={pattern color = black!80!Paired-7!70, pattern=crosshatch  dots} ] table [x=R, y expr=\thisrowno{7}-\thisrowno{6}] {\datapath/dat/E31225_samples_inter_8b_opti_spc4+.dat};
      \addplot+[draw=Paired-5, fill=Paired-5!40, postaction={pattern color = black!80!Paired-5!70, pattern=horizontal lines} ] table [x=R, y expr=\thisrowno{8}-\thisrowno{7}] {\datapath/dat/E31225_samples_inter_8b_opti_spc4+.dat};
      \addplot+[draw=Paired-9, fill=Paired-9!40, postaction={pattern color = black!80!Paired-9!70, pattern=grid}             ] table [x=R, y expr=\thisrowno{9}-\thisrowno{8}] {\datapath/dat/E31225_samples_inter_8b_opti_spc4+.dat};
    \end{axis}

    \begin{axis}[bar shift=+20pt,hide axis]
      \addplot+[draw=black,    fill=black!50                                                                                 ] table [x=R, y expr=\thisrowno{4}               ] {\datapath/dat/E31225_samples_inter_8b_opti_spc16-.dat};
      \addplot+[draw=Paired-1, fill=Paired-1!40, postaction={pattern color = black!80!Paired-1!70, pattern=north west  lines}] table [x=R, y expr=\thisrowno{5}-\thisrowno{4} ] {\datapath/dat/E31225_samples_inter_8b_opti_spc16-.dat};
      \addplot+[draw=Paired-3, fill=Paired-3!40, postaction={pattern color = black!80!Paired-3!70, pattern=north east  lines}] table [x=R, y expr=\thisrowno{6}-\thisrowno{5} ] {\datapath/dat/E31225_samples_inter_8b_opti_spc16-.dat};
      \addplot+[draw=Paired-7, fill=Paired-7!40, postaction={pattern color = black!80!Paired-7!70, pattern=crosshatch  dots} ] table [x=R, y expr=\thisrowno{7}-\thisrowno{6} ] {\datapath/dat/E31225_samples_inter_8b_opti_spc16-.dat};
      \addplot+[draw=Paired-5, fill=Paired-5!40, postaction={pattern color = black!80!Paired-5!70, pattern=horizontal lines} ] table [x=R, y expr=\thisrowno{8}-\thisrowno{7} ] {\datapath/dat/E31225_samples_inter_8b_opti_spc16-.dat};
      \addplot+[draw=Paired-9, fill=Paired-9!40, postaction={pattern color = black!80!Paired-9!70, pattern=grid}             ] table [x=R, y expr=\thisrowno{9}-\thisrowno{8} ] {\datapath/dat/E31225_samples_inter_8b_opti_spc16-.dat};
      \addplot+[draw=Paired-9, fill=Paired-9!10, postaction={pattern color = black!80!Paired-9!70, pattern=grid}             ] table [x=R, y expr=\thisrowno{10}-\thisrowno{9}] {\datapath/dat/E31225_samples_inter_8b_opti_spc16-.dat};

      % \legend{\texttt{ref}\text{ }, \texttt{R0}\text{ }, \texttt{R1}\text{ }, \texttt{REP}\text{ }, $\texttt{SPC}_\texttt{4}$\text{ } , $\texttt{SPC}_\texttt{4+}$ , $\texttt{SPC}_\texttt{16-}$}
    \end{axis}

  \end{tikzpicture}
\end{document}
