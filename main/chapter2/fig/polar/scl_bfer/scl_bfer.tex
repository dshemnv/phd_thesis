\documentclass{standalone}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{eulervm}
\usepackage{amsmath}
\usepackage{pgfplots}

\pgfplotsset{compat=newest}
\usepgfplotslibrary{colorbrewer}
\usepgfplotslibrary{groupplots}
\usetikzlibrary{matrix, positioning}

\input{colors}

\begin{document}
  \begin{tikzpicture}
    \begin{groupplot}[/pgfplots/table/ignore chars={|}, %footnotesize,
                      height=0.77\textwidth,  width=0.5\textwidth,
                      xticklabel style={black!70}, yticklabel style={black!70},
                      group style={group name=scl_2048, group size= 2 by 1, horizontal sep=2cm, vertical sep=2.2cm},
                      ymode = log,
                      ymin=0.000000001, ymax=0.05,
                      xmin=3.5, xmax=4.5, xtick={0,0.5,...,4.5},
                      xlabel=$E_b/N_0~\text{(dB)}$, grid=both, grid style={gray!30},
                      %tick align=outside, tickpos=left,
                      legend pos=south west]
      % \nextgroupplot[ylabel=BER]
      % \addplot[mark=x,        black,    semithick]                               table [x=Eb/N0, y=BER] {dat/rep/polar_2048_1723_1.0_4.5_ASCL32_CRC32_SPC4.txt};           \label{plot:line1}
      % \addplot[mark=square*,  Paired-3, semithick, dashed, mark options={solid}] table [x=Eb/N0, y=BER] {dat/rep/polar_2048_1723_1.0_4.5_ASCL32_CRC32_SPC4_16bits.txt};    \label{plot:line2}
      % \addplot[mark=triangle, Paired-5, semithick, dashed, mark options={solid}] table [x=Eb/N0, y=BER] {dat/rep/polar_2048_1723_1.0_4.5_ASCL32_CRC32_SPC4_8bits_rep.txt}; \label{plot:line3}
      % \addplot[mark=o,        Paired-7, semithick, dashed, mark options={solid}] table [x=Eb/N0, y=BER] {dat/rep/polar_2048_1723_1.0_4.5_ASCL32_CRC32_SPC4_8bits.txt};     \label{plot:line4}

      \nextgroupplot[ylabel=FER]
      \addplot[mark=x,        black,    semithick]                               table [x=Eb/N0, y=FER] {dat/rep/polar_2048_1723_1.0_4.5_ASCL32_CRC32_SPC4.txt};           \label{plot:line1}
      \addplot[mark=square*,  Paired-3, semithick, dashed, mark options={solid}] table [x=Eb/N0, y=FER] {dat/rep/polar_2048_1723_1.0_4.5_ASCL32_CRC32_SPC4_16bits.txt};    \label{plot:line2}
      \addplot[mark=triangle, Paired-5, semithick, dashed, mark options={solid}] table [x=Eb/N0, y=FER] {dat/rep/polar_2048_1723_1.0_4.5_ASCL32_CRC32_SPC4_8bits_rep.txt}; \label{plot:line3}
      \addplot[mark=o,        Paired-7, semithick, dashed, mark options={solid}] table [x=Eb/N0, y=FER] {dat/rep/polar_2048_1723_1.0_4.5_ASCL32_CRC32_SPC4_8bits.txt};     \label{plot:line4}

      % \legend{\text{ }float  (ref)\text{ } $\texttt{rep}_{\texttt{2+}}$,
      %                16-bit  $Q_{6,1}$     $\texttt{rep}_{\texttt{2+}}$,
      %         \text{ }8-bit  $Q_{6,1}$     $\texttt{rep}_{\texttt{2+}}$,
      %         \text{ }8-bit  $Q_{6,1}$     $\texttt{rep}_{\texttt{8-}}$}

      % \legend{\text{ }ref\text{ } $\texttt{rep}_{\texttt{2+}}$,
      %                16-bit       $\texttt{rep}_{\texttt{2+}}$,
      %         \text{ }8-bit       $\texttt{rep}_{\texttt{2+}}$,
      %         \text{ }8-bit       $\texttt{rep}_{\texttt{8-}}$}

      % create a (dummy) coordinate where we want to place the legend
      %
      % (The matrix cannot be placed inside the `axis' environment
      %  directly, because then a catcode error is raised.
      %  I guess that this is caused by the `matrix of nodes' feature)
      % \coordinate (legend) at (axis description cs:0.97,0.03);
      \coordinate (legend) at (axis description cs:0.76,0.02);

      \nextgroupplot[ylabel=FER, xmin=3.5, xmax=4.5]
      \addplot[mark=o,        Paired-1,    semithick                              ] table [x=Eb/N0, y=FER] {dat/crc/SCL+CRC8.txt};     \label{plot:line5}
      \addplot[mark=o,        Paired-1!70, semithick, dashed, mark options={solid}] table [x=Eb/N0, y=FER] {dat/crc/FA-SCL+CRC8.txt};  \label{plot:line6}
      \addplot[mark=triangle, Paired-3,                                           ] table [x=Eb/N0, y=FER] {dat/crc/SCL+CRC16.txt};    \label{plot:line7}
      \addplot[mark=triangle, Paired-3!70, semithick, dashed, mark options={solid}] table [x=Eb/N0, y=FER] {dat/crc/FA-SCL+CRC16.txt}; \label{plot:line8}
      \addplot[mark=square,   Paired-5,                                           ] table [x=Eb/N0, y=FER] {dat/crc/SCL+CRC32.txt};    \label{plot:line9}
      \addplot[mark=square,   Paired-5!70, semithick, dashed, mark options={solid}] table [x=Eb/N0, y=FER] {dat/crc/FA-SCL+CRC32.txt}; \label{plot:line10}

      % create a (dummy) coordinate where we want to place the legend
      %
      % (The matrix cannot be placed inside the `axis' environment
      %  directly, because then a catcode error is raised.
      %  I guess that this is caused by the `matrix of nodes' feature)
      % \coordinate (legend) at (axis description cs:0.97,0.03);
      \coordinate (legend2) at (axis description cs:0.87,0.02);
    \end{groupplot}
    % create the legend matrix which is placed at the created (dummy) coordinate
    % and recall the plot specification using the `\ref' command
    %
    % adapt the style of that node to your needs
    % (e.g. if you like different spacings between the rows or columns
    %  or a fill color)
    \matrix [
        draw,
        matrix of nodes,
        anchor=south east,
        fill=white
    ] at (legend) {
        \ref{plot:line1} & \small{float}  & $\texttt{REP}_\texttt{2+}$  \\
        \ref{plot:line2} & \small{16-bit} & $\texttt{REP}_\texttt{2+}$  \\
        \ref{plot:line3} & \small{8-bit}  & $\texttt{REP}_\texttt{2+}$  \\
        \ref{plot:line4} & \small{8-bit}  & $\texttt{REP}_\texttt{8-}$  \\
    };

    % create the legend matrix which is placed at the created (dummy) coordinate
    % and recall the plot specification using the `\ref' command
    %
    % adapt the style of that node to your needs
    % (e.g. if you like different spacings between the rows or columns
    %  or a fill color)
    \matrix [
        draw,
        matrix of nodes,
        anchor=south east,
        fill=white
    ] at (legend2) {
        \small{CRC}    & \small{SSCL}      & \small{A-SSCL}   \\
        \small{8-bit}  & \ref{plot:line5} & \ref{plot:line6}  \\
        \small{16-bit} & \ref{plot:line7} & \ref{plot:line8}  \\
        \small{32-bit} & \ref{plot:line9} & \ref{plot:line10} \\
    };

    % \node[below = 0.7cm of be c1r1.south] {(a) : DVB-RCS - K=440 R=1/3 - BE};
    % \node[below = 0.7cm of be c2r1.south] {(b) : DVB-RCS - K=440 R=1/3 - SE};

    \node[below = 1.3cm of scl_2048 c1r1.south, align=left] {(a): Impact of the \texttt{REP} node size \\ on fixed-point SSCL decoding};
    \node[below = 1.3cm of scl_2048 c2r1.south, align=left] {(b): Impact of the CRC size \\ on SSCL and A-SSCL decoding};

  \end{tikzpicture}
\end{document}
