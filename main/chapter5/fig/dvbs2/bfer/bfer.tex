\providecommand{\datapath}{.}
\documentclass[tikz]{standalone}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{eulervm}
\usepackage{amsmath}
\usepackage{pgfplots}

\pgfplotsset{compat=newest}
\usepgfplotslibrary{colorbrewer}
\usepgfplotslibrary{groupplots}
\usetikzlibrary{matrix, positioning}

\input{./settings/colors}

\begin{document}
  \begin{tikzpicture}
    \begin{groupplot}[/pgfplots/table/ignore chars={|}, %footnotesize,
                      height=0.77\textwidth, width=1.0\textwidth,
                      xticklabel style={black!70}, yticklabel style={black!70},
                      group style={group name=scl_2048, group size= 2 by 1, horizontal sep=2cm, vertical sep=2.0cm},
                      ymode = log,
                      % ymin=0.000000001, ymax=0.05,
                      % xmin=0, xmax=2,
                      % xtick={0,0.5,...,4.5},
                      xlabel=$E_b/N_0~\text{(dB)}$,
                      grid=both, grid style={gray!30},
                      %tick align=outside, tickpos=left,
                      legend pos=north east]
      \nextgroupplot[ylabel=BER]

      \addplot[mark=square,    Paired-1,    semithick, dashed, mark options={solid}] table [x=Eb/N0, y=BER] {\datapath/dat/data_QPSK_R_3_5_BB.txt};  \label{plot:line1}
      \addplot[mark=triangle,  Paired-1!80, semithick, dashed, mark options={solid}] table [x=Eb/N0, y=BER] {\datapath/dat/data_QPSK_R_3_5_sim.txt}; \label{plot:line2}
      \addplot[mark=o,         Paired-1!60, semithick, dashed, mark options={solid}, domain=0:0.2, error bars/.cd, x dir=both,x fixed=0.2, y dir=both,y explicit, error bar style={solid}] table [x=Eb/N0, y=BER] {\datapath/dat/data_QPSK_R_3_5_rad.txt}; \label{plot:line3}

      \addplot[mark=square,    Paired-3,    semithick, dotted, mark options={solid}] table [x=Eb/N0, y=BER] {\datapath/dat/data_QPSK_R_8_9_BB.txt};  \label{plot:line4}
      \addplot[mark=triangle,  Paired-3!80, semithick, dotted, mark options={solid}] table [x=Eb/N0, y=BER] {\datapath/dat/data_QPSK_R_8_9_sim.txt}; \label{plot:line5}
      \addplot[mark=o,         Paired-3!60, semithick, dotted, mark options={solid}, domain=0:0.2, error bars/.cd, x dir=both,x fixed=0.2, y dir=both,y explicit, error bar style={solid}] table [x=Eb/N0, y=BER] {\datapath/dat/data_QPSK_R_8_9_rad.txt}; \label{plot:line6}

      \addplot[mark=square,    Paired-5,    semithick,         mark options={solid}] table [x=Eb/N0, y=BER] {\datapath/dat/data_8PSK_R_8_9_BB.txt};  \label{plot:line7}
      \addplot[mark=triangle,  Paired-5!80, semithick,         mark options={solid}] table [x=Eb/N0, y=BER] {\datapath/dat/data_8PSK_R_8_9_sim.txt}; \label{plot:line8}
      \addplot[mark=o,         Paired-5!60, semithick,         mark options={solid}, domain=0:0.2, error bars/.cd, x dir=both,x fixed=0.2, y dir=both,y explicit, error bar style={solid}] table [x=Eb/N0, y=BER] {\datapath/dat/data_8PSK_R_8_9_rad.txt}; \label{plot:line9}

      \coordinate (legend) at (axis description cs:1.375,1.05);

      \nextgroupplot[ylabel=FER]

      \addplot[mark=square,    Paired-1,    semithick, dashed, mark options={solid}] table [x=Eb/N0, y=FER] {\datapath/dat/data_QPSK_R_3_5_BB.txt};  \label{plot:line1}
      \addplot[mark=triangle,  Paired-1!80, semithick, dashed, mark options={solid}] table [x=Eb/N0, y=FER] {\datapath/dat/data_QPSK_R_3_5_sim.txt}; \label{plot:line2}
      \addplot[mark=o,         Paired-1!60, semithick, dashed, mark options={solid}, domain=0:0.2, error bars/.cd, x dir=both,x fixed=0.2, y dir=both,y explicit, error bar style={solid}] table [x=Eb/N0, y=FER] {\datapath/dat/data_QPSK_R_3_5_rad.txt}; \label{plot:line3}

      \addplot[mark=square,    Paired-3,    semithick, dotted, mark options={solid}] table [x=Eb/N0, y=FER] {\datapath/dat/data_QPSK_R_8_9_BB.txt};  \label{plot:line4}
      \addplot[mark=triangle,  Paired-3!80, semithick, dotted, mark options={solid}] table [x=Eb/N0, y=FER] {\datapath/dat/data_QPSK_R_8_9_sim.txt}; \label{plot:line5}
      \addplot[mark=o,         Paired-3!60, semithick, dotted, mark options={solid}, domain=0:0.2, error bars/.cd, x dir=both,x fixed=0.2, y dir=both,y explicit, error bar style={solid}] table [x=Eb/N0, y=FER] {\datapath/dat/data_QPSK_R_8_9_rad.txt}; \label{plot:line6}

      \addplot[mark=square,    Paired-5,    semithick,         mark options={solid}] table [x=Eb/N0, y=FER] {\datapath/dat/data_8PSK_R_8_9_BB.txt};  \label{plot:line7}
      \addplot[mark=triangle,  Paired-5!80, semithick,         mark options={solid}] table [x=Eb/N0, y=FER] {\datapath/dat/data_8PSK_R_8_9_sim.txt}; \label{plot:line8}
      \addplot[mark=o,         Paired-5!60, semithick,         mark options={solid}, domain=0:0.2, error bars/.cd, x dir=both,x fixed=0.2, y dir=both,y explicit, error bar style={solid}] table [x=Eb/N0, y=FER] {\datapath/dat/data_8PSK_R_8_9_rad.txt}; \label{plot:line9}
    \end{groupplot}

    \matrix [
        draw,
        matrix of nodes,
        anchor=south east,
        fill=white
    ] at (legend) {
                 & QPSK    & QPSK    & 8-PSK   \\
                 & $R=3/5$ & $R=8/9$ & $R=8/9$ \\
        AWGN     & \ref{plot:line1} & \ref{plot:line4} & \ref{plot:line7} \\
        AWGN$^+$ & \ref{plot:line2} & \ref{plot:line5} & \ref{plot:line8} \\
        Real     & \ref{plot:line3} & \ref{plot:line6} & \ref{plot:line9} \\
    };

  \end{tikzpicture}
\end{document}
